- name: Install rofi-calc dependencies
  become: true
  loop: "{{ packages }}"
  ansible.builtin.apt:
    name: "{{ item }}"
    state: present

- name: Import rofi-calc repo
  ansible.builtin.git:
    repo: https://github.com/svenstaro/rofi-calc
    dest: "{{ build_directory }}"
    version: master

- name: Update configuration files
  ansible.builtin.command:
    cmd: autoreconf -i
    chdir: "{{ build_directory }}"
  changed_when: false

- name: Clear configuration
  ansible.builtin.file:
    path: "{{ build_directory }}/build"
    state: absent

- name: Creates build directory if not exists
  ansible.builtin.file:
    path: "{{ build_directory }}/build"
    state: directory
    mode: u=rwx,g=r,o=r

- name: Configure
  ansible.builtin.command:
    cmd: ../configure
    chdir: "{{ build_directory }}/build"
  changed_when: false

- name: Make
  ansible.builtin.command:
    cmd: make
    chdir: "{{ build_directory }}/build"
  changed_when: false

- name: Install
  become: true
  ansible.builtin.command:
    cmd: make install
    chdir: "{{ build_directory }}/build"
  changed_when: false
